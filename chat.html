<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Chat with ManoVeda</title> <!-- Use your external chat.css --> <link rel="stylesheet" href="chat.css" /> <link rel="icon" type="image/png" href="bingo.png" /> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"> </head> <body> <div class="chat-container"> <!-- Top Navigation --> <nav id="navbar"> <div class="glass"> <div class="brand">Mano<span>Veda AI</span></div> <a class="back" href="Index.html">← Dashboard</a> <!-- optional mobile menu toggle if present in your layout --> <button id="mobile-menu-toggle" aria-label="Toggle menu" style="display:none;">☰</button> </div> </nav> <!-- Chat Messages --> <div class="chat-box" id="chatBox"> <!-- Messages injected by the inline script --> </div> <!-- Input Area --> <div class="chat-input-area"> <input type="text" id="userInput" placeholder="Type your thoughts here..." autocomplete="off" /> <button id="sendBtn">Send</button> </div> </div> <!-- JS FOR NAV, SCROLL, AND CHAT (inline, like your friend's file) --> <script> // DOM ready document.addEventListener("DOMContentLoaded", () => { // Mobile menu toggle (if you actually have a mobile menu) const mobileMenuToggle = document.getElementById('mobile-menu-toggle'); const mobileMenu = document.getElementById('mobile-menu'); if (mobileMenuToggle && mobileMenu) { mobileMenuToggle.addEventListener('click', () => mobileMenu.classList.toggle('hidden')); mobileMenu.addEventListener('click', (e) => { if (e.target.tagName === 'A') mobileMenu.classList.add('hidden'); }); } // Smooth scrolling for internal anchor links document.querySelectorAll('a[href^="#"]').forEach(anchor => { anchor.addEventListener('click', function (e) { e.preventDefault(); const targetId = this.getAttribute('href'); const targetElement = document.querySelector(targetId); if (targetElement) { window.scrollTo({ top: targetElement.offsetTop - 100, behavior: 'smooth' }); } }); }); // Navbar background change on scroll (if navbar exists) const navbar = document.getElementById('navbar'); if (navbar) { window.addEventListener('scroll', () => { try { const glass = navbar.querySelector('.glass'); if (!glass) return; if (window.scrollY > 100) { glass.style.background = 'rgba(255, 255, 255, 0.95)'; } else { glass.style.background = 'rgba(255, 255, 255, 0.85)'; } } catch (e) { /* ignore */ } }); } // Fade-in observer (if you use .fade-in elements) const observer = new IntersectionObserver(entries => { entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add("visible"); }); }); document.querySelectorAll(".fade-in").forEach(el => observer.observe(el)); // Chatbot logic const sendBtn = document.getElementById("sendBtn"); const inputEl = document.getElementById("userInput"); const chatBox = document.getElementById("chatBox"); if (!sendBtn || !inputEl || !chatBox) { console.error("Chat UI elements missing (sendBtn, userInput or chatBox)."); return; } // Helper to append bubbles -- keeping the style your friend used function appendUserMessage(text) { chatBox.innerHTML += <div class='chat-bubble bg-green-100 text-green-800 self-end float-right'><b>You:</b> ${escapeHtml(text)}</div><div class='clear-both'></div>; chatBox.scrollTop = chatBox.scrollHeight; } function appendAIMessage(text) { chatBox.innerHTML += <div class='chat-bubble bg-gray-100 text-gray-800 float-left'><b>Manoveda:</b> ${escapeHtml(text)}</div><div class='clear-both'></div>; chatBox.scrollTop = chatBox.scrollHeight; } // Basic HTML escaping to prevent injection function escapeHtml(unsafe) { return unsafe .replace(/&/g, "&amp;") .replace(/</g, "&lt;") .replace(/>/g, "&gt;") .replace(/"/g, "&quot;") .replace(/'/g, "&#039;"); } // Main send function async function sendMessage() { const userMsg = inputEl.value.trim(); if (!userMsg) return; // Add user message immediately appendUserMessage(userMsg); inputEl.value = ""; // Add typing indicator const typingId = "typing-indicator"; chatBox.innerHTML += <div id="${typingId}" class="chat-bubble typing">Manoveda is typing...</div><div class='clear-both'></div>; chatBox.scrollTop = chatBox.scrollHeight; try { const response = await fetch("https://vxknarwomlejxksmjinx.supabase.co/functions/v1/manoveda-ai", { method: "POST", headers: { "Content-Type": "application/json", "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ4a25hcndvbWxlanhrc21qaW54Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyNTAzMjcsImV4cCI6MjA4NTgyNjMyN30.EG9iRbnR98roL18qEL6zmJLKbbROc0mSPmNh1MZnBZ4" }, body: JSON.stringify({ userMsg }) }); // Remove typing indicator (if still present) const typingEl = document.getElementById(typingId); if (typingEl) typingEl.remove(); // Parse and handle response const data = await response.json(); if (!response.ok) { console.error("Backend error:", data); appendAIMessage("Server error. Check your backend (401 means token missing)."); return; } const reply = data?.reply || "Sorry, I couldn’t answer that."; appendAIMessage(reply); } catch (err) { // Remove typing indicator (if still present) const typingEl = document.getElementById(typingId); if (typingEl) typingEl.remove(); console.error("Network error:", err); chatBox.innerHTML += <div class='text-red-500 mt-2'>⚠️ Error: ${escapeHtml(err.message || String(err))}</div>; chatBox.scrollTop = chatBox.scrollHeight; } } // Button + Enter key binding sendBtn.addEventListener("click", sendMessage); inputEl.addEventListener("keydown", (e) => { if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); sendMessage(); } }); }); </script> </body> </html>
